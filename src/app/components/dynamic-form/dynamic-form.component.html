<div>
  <form (ngSubmit)="onSubmit(form.value)" [formGroup]="form" *ngIf="form">

    <span class="form-row justify-content-center">
      <!-- <img src="../../../assets/shapes.svg" class="mx-auto d-block" style="margin-top: 2%;"/> -->
      <!-- <app-dynamic-form-question [question]="questions[0]" [form]="form"></app-dynamic-form-question>-->

      <img [src]="createImagePath(imageEngin)" class="mt-2 mr-3" />

      <mat-vertical-stepper style="margin-top: 2%; margin-left: 3%;" #stepper [dir]="dir">
        <mat-step *ngFor="let question of questions; let i=index;" [stepControl]="question">
          <div [formGroup]="form">
            <ng-template matStepLabel>{{question.key}}</ng-template>
            <app-dynamic-form-question [question]="question" [form]="form">
            </app-dynamic-form-question>
            <div dir="ltr">
              <button mat-raised-button matStepperPrevious *ngIf="i == 1 || i == 2">Précedent</button>
              <button mat-raised-button matStepperNext *ngIf="i == 0 || i == 1 || i == 2" class="ml-2">Suivant</button>
            </div>
          </div>
        </mat-step>

        <mat-step [stepControl]="formConducteur">
          <ng-template matStepLabel>السائق</ng-template>
          <div [formGroup]="formConducteur">
            <diV>
              <mat-form-field style="text-align: left" dir="ltr">
                <input type="text" matInput formControlName="cin" placeholder="C.I.N" [matAutocomplete]="cin" />
              </mat-form-field>

              <mat-autocomplete #cin="matAutocomplete" (optionSelected)="getConducteur($event)">
                <mat-option *ngFor="let conducteur of (filteredConducteurs | async)" [value]="conducteur.cin">
                  {{conducteur.cin}}</mat-option>
              </mat-autocomplete>
            </diV>
            <div>
              <mat-form-field style="text-align: left" dir="ltr">
                <input type="text" matInput formControlName="nomComplet" placeholder="Nom Complet"
                  [value]="formConducteur.controls['cin'].value !== '' ? nomComplet.value : ''" />
              </mat-form-field>
            </div>
          </div>


          <div dir="ltr">
            <button mat-raised-button matStepperPrevious class="mr-2">Précedent</button>
            <button mat-raised-button class="mr-2" matSepperNext (click)="onSub(form.value)">Suivant</button>
          </div>
        </mat-step>

        <mat-step [stepControl]="formEngin">
          <ng-template matStepLabel>العربة</ng-template>
          <div [formGroup]="formEngin">
            <diV>
              <mat-form-field style="text-align: left" dir="ltr">
                <input type="text" matInput formControlName="matricule" placeholder="Matricule" [matAutocomplete]="matricule" />
              </mat-form-field>

              <mat-autocomplete #matricule="matAutocomplete" (optionSelected)="getMatricule($event)">
                <mat-option *ngFor="let vehicule of (filteredVehicules | async)" [value]="vehicule.matricule">
                  {{vehicule.matricule}}</mat-option>
              </mat-autocomplete>
            </diV>
          </div>
          <div dir="ltr">
            <button mat-raised-button matStepperPrevious class="mr-2">Précedent</button>
            <button mat-raised-button class="mr-2" matSepperNext (click)="onSub(form.value)">Suivant</button>
          </div>
        </mat-step>

        <mat-step [stepControl]="null">
          <ng-template matStepLabel>تأكيد</ng-template>
          <div dir="ltr">
            <ngb-rating [rate]="3.75"></ngb-rating>
          </div>
          <div dir="ltr">
            <button mat-raised-button matStepperPrevious class="mr-2">Précedent</button>
            <button mat-raised-button class="mr-2" matSepperNext (click)="onSub(form.value)">Envoyer</button>
          </div>
        </mat-step>
      </mat-vertical-stepper>
    </span>

    <!-- <div class="form-row">
      <button type="submit" [disabled]="!form.valid">Save</button>
    </div> -->
  </form>

  <!-- <div *ngIf="payLoad" class="form-row">
    <strong>Saved the following values</strong><br>{{payLoad}}
  </div> -->
</div>
<!-- [ngClass]="{'justify-content-end': i === 0, 'justify-content-center': i === 1, 'justify-content-start': i === 2}" -->